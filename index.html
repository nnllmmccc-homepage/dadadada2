<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ImageShare - ç”»åƒå…±æœ‰</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #f9fafb; font-family: 'Inter', sans-serif; }
    .hidden { display: none; }
  </style>
</head>

<body class="min-h-screen flex flex-col items-center justify-center p-6">

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <h1 class="text-4xl font-bold text-indigo-700 mb-6">ğŸ“¸ ImageShare</h1>

  <!-- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒ  -->
  <div id="uploadSection" class="bg-white shadow-xl rounded-2xl p-8 w-full max-w-lg text-center">
    <p class="text-gray-600 mb-4">ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦Discordã§å…±æœ‰ã§ãã¾ã™</p>
    <input type="file" id="fileInput" accept="image/*" class="hidden">
    <label for="fileInput" id="uploadArea" 
      class="cursor-pointer border-4 border-dashed border-indigo-300 rounded-xl py-12 block hover:border-indigo-500 hover:bg-indigo-50 transition">
      <svg class="w-16 h-16 mx-auto text-indigo-400 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1M12 12V3m0 9l3-3m-3 3l-3-3" />
      </svg>
      <p class="text-lg text-gray-700 font-medium">ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ</p>
      <p class="text-sm text-gray-500 mt-1">PNG, JPG, GIF (æœ€å¤§5MB)</p>
    </label>

    <div id="uploading" class="hidden mt-4 text-gray-500 animate-pulse">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</div>
  </div>

  <!-- å®Œäº†ç”»é¢ -->
  <div id="resultSection" class="hidden bg-white shadow-xl rounded-2xl p-8 w-full max-w-lg text-center">
    <img id="uploadedPreview" src="" alt="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒ" class="rounded-lg mb-4 mx-auto max-h-64 object-contain">
    <p class="text-gray-700 mb-4">ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’Discordã«è²¼ã‚‹ã¨ç”»åƒãŒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã•ã‚Œã¾ã™ğŸ‘‡</p>
    <input type="text" id="shareLink" readonly class="w-full border rounded-lg px-4 py-2 mb-3 text-sm text-gray-700 bg-gray-50">
    <button onclick="copyLink()" 
      class="bg-indigo-600 text-white px-5 py-2 rounded-lg hover:bg-indigo-700 transition font-medium">
      ã‚³ãƒ”ãƒ¼
    </button>
    <button onclick="location.reload()" 
      class="ml-2 bg-gray-200 text-gray-700 px-5 py-2 rounded-lg hover:bg-gray-300 transition font-medium">
      åˆ¥ã®ç”»åƒã‚’ã‚¢ãƒƒãƒ—
    </button>
  </div>

  <script>
    // âœ… è¨­å®š
    const uploadFolder = "uploads/"; // ç”»åƒã‚’ä¿å­˜ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆã‚µãƒ¼ãƒãƒ¼ä¸Šã«å­˜åœ¨ã•ã›ã¦ãŠãï¼‰

    const fileInput = document.getElementById("fileInput");
    const uploadArea = document.getElementById("uploadArea");
    const uploadingText = document.getElementById("uploading");
    const uploadSection = document.getElementById("uploadSection");
    const resultSection = document.getElementById("resultSection");
    const uploadedPreview = document.getElementById("uploadedPreview");
    const shareLink = document.getElementById("shareLink");

    fileInput.addEventListener("change", async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      if (!file.type.startsWith("image/")) return alert("ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„");
      if (file.size > 5 * 1024 * 1024) return alert("5MBä»¥ä¸‹ã«ã—ã¦ãã ã•ã„");

      uploadArea.classList.add("hidden");
      uploadingText.classList.remove("hidden");

      // âœ… ãƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆï¼ˆé‡è¤‡é˜²æ­¢ï¼‰
      const ext = file.name.split(".").pop();
      const fileName = Date.now() + "_" + Math.random().toString(36).substring(2, 8) + "." + ext;

      // âœ… ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      try {
        const formData = new FormData();
        formData.append("file", file);

        // âš ï¸ ã“ã®éƒ¨åˆ†ã¯ã‚µãƒ¼ãƒãƒ¼å´ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†ï¼ˆä¾‹: PHP, Node, Pythonï¼‰
        // ã“ã“ã§ã¯ãƒ‡ãƒ¢çš„ã«ã€Œã™ã§ã«uploadsã«ç½®ã‹ã‚Œã¦ã„ã‚‹ã€ã¨ä»®å®š
        const fakePath = uploadFolder + fileName;

        // è¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ãˆ
        uploadingText.classList.add("hidden");
        resultSection.classList.remove("hidden");
        uploadSection.classList.add("hidden");
        uploadedPreview.src = fakePath;

        // âœ… ã‚·ã‚§ã‚¢URLã‚’ç”Ÿæˆ
        const base = window.location.origin + window.location.pathname.replace(/index\.html$/, "");
        const link = `${base}view.html?url=${encodeURIComponent(fakePath)}&title=${encodeURIComponent(file.name)}`;
        shareLink.value = link;

      } catch (err) {
        alert("ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—: " + err.message);
      }
    });

    function copyLink() {
      shareLink.select();
      document.execCommand("copy");
      alert("ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }
  </script>
</body>
</html>
