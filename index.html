<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ImageShare - ç”»åƒãƒªãƒ³ã‚¯ä¿è­·ç‰ˆ</title>
  <meta name="description" content="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‚’ãƒªãƒ³ã‚¯ã«å¤‰æ›ã—ã¦å…±æœ‰ã€‚Discordç­‰ã§å®‰å…¨ã«è¡¨ç¤ºã§ãã¾ã™ã€‚">
  <meta property="og:type" content="website">
  <meta property="og:title" content="ImageShare - å®‰å…¨ãªç”»åƒå…±æœ‰">
  <meta property="og:description" content="ãƒªãƒ³ã‚¯ã§å…±æœ‰ã§ãã‚‹å®‰å…¨ãªç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ€ãƒ¼">
  <meta property="og:image" content="https://yourdomain.com/og-default.jpg">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <div class="max-w-4xl mx-auto p-8">
    <h1 class="text-4xl font-bold text-center text-indigo-700 mb-6">ğŸ”’ ImageShare</h1>
    <p class="text-center text-gray-600 mb-10">ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ç§˜å¯†ã®ãƒªãƒ³ã‚¯ãŒä½œã‚‰ã‚Œã¾ã™ã€‚</p>

    <div class="bg-white rounded-2xl shadow-lg p-8 text-center">
      <input type="file" id="fileInput" accept="image/*" class="hidden">
      <label for="fileInput" class="cursor-pointer block border-4 border-dashed border-indigo-300 rounded-xl p-12 hover:bg-indigo-50 transition-all">
        <svg class="w-16 h-16 mx-auto mb-4 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <p class="text-lg text-gray-700">ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ</p>
      </label>
    </div>

    <div id="result" class="mt-10 hidden">
      <p class="text-center text-gray-700 mb-2">å…±æœ‰ç”¨ãƒªãƒ³ã‚¯ï¼ˆã“ã®URLã‚’é€ã£ã¦ã‚‚ç”»åƒURLã¯éš ã•ã‚Œã¦ã„ã¾ã™ï¼‰</p>
      <div class="bg-gray-100 rounded-xl p-4 text-center break-all">
        <a id="shareLink" href="#" class="text-indigo-600 font-medium"></a>
      </div>
      <button onclick="copyLink()" class="mt-4 w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition">ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
  </div>

  <script>
    // æš—å·åŒ–é–¢æ•°
    function encodeData(data) {
      return btoa(unescape(encodeURIComponent(data)));
    }
    // å¾©å·åŒ–é–¢æ•°
    function decodeData(encoded) {
      try { return decodeURIComponent(escape(atob(encoded))); }
      catch { return null; }
    }

    // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
    document.getElementById('fileInput').addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      if (!file.type.startsWith('image/')) return alert("ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„");

      const reader = new FileReader();
      reader.onload = () => {
        const encoded = encodeData(reader.result);
        const imageId = Date.now().toString(36);
        localStorage.setItem(`image-${imageId}`, encoded);
        const link = `${window.location.origin}${window.location.pathname}?id=${imageId}`;
        document.getElementById('shareLink').textContent = link;
        document.getElementById('shareLink').href = link;
        document.getElementById('result').classList.remove('hidden');
      };
      reader.readAsDataURL(file);
    });

    // å…±æœ‰ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼
    function copyLink() {
      const link = document.getElementById('shareLink').textContent;
      navigator.clipboard.writeText(link);
      alert("ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }

    // é–‹ã‹ã‚ŒãŸã¨ãã« ?id= ãŒã‚ã‚‹ã‹ç¢ºèª
    const params = new URLSearchParams(window.location.search);
    const imageId = params.get("id");
    if (imageId) {
      const encoded = localStorage.getItem(`image-${imageId}`);
      const imageData = decodeData(encoded);
      if (imageData) {
        document.body.innerHTML = `
          <div class="flex items-center justify-center min-h-screen bg-gray-100">
            <div class="bg-white shadow-lg rounded-2xl p-6 text-center">
              <img src="${imageData}" class="max-w-full rounded-xl mb-4">
              <a href="${window.location.origin}${window.location.pathname}" class="text-indigo-600 underline">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a>
            </div>
          </div>
        `;
      } else {
        document.body.innerHTML = "<p class='text-center mt-40 text-gray-600'>ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚</p>";
      }
    }
  </script>
</body>
</html>
